<!DOCTYPE html>
<html lang="en">

<head>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Welcome Retailer</title>
    <!-- Compiled and minified CSS -->

    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="/stylesheets/materialize.css" media="screen,projection" />
    <!-- <link type="text/css" rel="stylesheet" href="/stylesheets/materialize.css">
         -->
    <!-- <link type="text/css" rel="stylesheet" href="/stylesheets/style.css" media="screen,projection"/> -->

    <link rel="stylesheet" type="text/css" href="http://www.highcharts.com/media/com_demo/highslide.css" />
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">
    <link href="/stylesheets/font-awesome.min.css" rel="stylesheet">
    <link href="/stylesheets/prettyPhoto.css" rel="stylesheet">
    <link href="/stylesheets/price-range.css" rel="stylesheet">
    <link href="/stylesheets/animate.css" rel="stylesheet">
    <link href="/stylesheets/main.css" rel="stylesheet">
    <link href="/stylesheets/responsive.css" rel="stylesheet">

    <!--        <link type="text/css" rel="stylesheet" href="../public/stylesheets/ghpages-materialize.css">-->

    <link rel="shortcut icon" href="images/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="images/ico/apple-touch-icon-57-precomposed.png">

    <style>
        .card-header {
            font-size: 1.2em;
        }
        #dateCard-time{
            font-size: 1.5em;
        }
        #dateCard-day{
            font-size: 0.8em;
        }
        #dateCard-date{
            font-size: 0.8em;
        }
    </style>

</head>

<body>
    <header id="header">
        <div class="header-middle">
            <!--header-middle-->
            <div class="container">
                <div class="row">
                    <div class="col-sm-4">
                        <div class="logo pull-left">
                            <a href="index.html"><img src="/images/home/logo.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="shop-menu pull-right">
                            <ul class="nav navbar-nav">
                                <li><a onclick="logOut()"><i class="fa fa-lock"></i> Log Out</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--/header-middle-->
        <div class="header-bottom">
            <!--header-bottom-->
            <div class="container">
                <div class="row">
                    <div class="col-sm-9">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                        </div>
                        <div class="mainmenu pull-left">
                            <ul class="nav navbar-nav collapse navbar-collapse">
                                <li><a onclick="showDashboard()" class="active">Dashboard</a></li>
                                <li class="dropdown"><a href="#">Items<i class="fa fa-angle-down"></i></a>
                                    <ul role="menu" class="sub-menu">
                                        <li><a onclick="addItem()">Add Items</a></li>
                                        <li><a onclick="getItemList()">View Items</a></li>
                                    </ul>
                                </li>
                                <li class="dropdown"><a href="#">Orders<i class="fa fa-angle-down"></i></a>
                                    <ul role="menu" class="sub-menu">
                                        <li><a onclick="updateOrder()">Update Orders</a></li>
                                        <li><a onclick="getOrderList()">View Orders</a></li>
                                    </ul>
                                </li>

                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="search_box pull-right">
                            <input type="text" placeholder="Search" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--/header-bottom-->
    </header>
    <!--/header-->

    <section id="retailerDashboard">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="section">
                        <div class="row" id="row1">
                            <div class="col-lg-2 col-md-4 col-sm-6 col-xs-12">
                                <div class="card grey darken-3" id="dateCard">
                                    <div class="card-content waves-effect waves-block waves-dark">
                                        <!-- <div class="card-header white-text">Date</div> -->
                                        <div class="center-align">
                                            <span class="white-text " id="dateCard-time"></span>
                                            <span id="dateCard-day" class="white-text left-align"></span>
                                            <br/>
                                            <span class="white-text left-align" id="dateCard-date"></span>
                                            <br/>
                                            
                                        </div>
                                    </div>
                                </div>
                                <div class="card ">
                                    <div class="card-image waves-effect waves-block waves-light">
                                        <img class="activator" src="/images/girl1.jpg">
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-header grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>

                            </div>
                            <div class="col-lg-2 col-md-4 col-sm-6 col-xs-12">
                                <div class="card  grey darken-3" id="avgSaleCard">
                                    <div class="card-content waves-effect waves-block waves-dark">
                                        <div class="card-header white-text">Average Sale</div>
                                        <div class="center">
                                            <span class="white-text" id="avgSaleCard-month"></span>
                                            <br/>
                                            <span class="white-text" id="avgSaleCard-year"></span>
                                        </div>
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-header grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                                <div class="card  grey darken-3" id="totalSaleCard">
                                    <div class="card-content waves-effect waves-block waves-dark">
                                        <div class="card-header white-text">Total Sale</div>
                                        <div class="center">
                                            <span class="white-text" id="totalSaleCard-month"></span>
                                            <br/>
                                            <span class="white-text" id="totalSaleCard-year"></span>
                                        </div>
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-header grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-8 col-sm-6 col-xs-12">
                                <div class="card">
                                    <!-- <div class="card-header black-text">Sale Trends</div> -->
                                    <div id="saleTrendsGraph" class="center card-image waves-effect waves-block waves-light">
                                        <!--<img class="activator" src="/images/girl1.jpg">-->
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-8 col-sm-6 col-xs-12">
                                <div class="card">
                                    <!-- <div class="card-header black-text">Sale Trends</div> -->
                                    <div id="topProductsChartSample" class="center card-image waves-effect waves-block waves-light">
                                        <!--<img class="activator" src="/images/girl1.jpg">-->
                                    </div>
                                
                                </div>
                            </div>
                        </div>
                        <div class="row" id="row2">
                            <div class="col-lg-3 col-md-6 col-sm-12">


                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card">
                                    <!-- <div class="card-header black-text">Top Products</div> -->
                                    <div id="topProductsChart" class="center card-image waves-effect waves-block waves-light">

                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12 col-sm-12">
                                <div class="card">
                                    <!-- <div class="card-header black-text">Sales Location</div> -->
                                    <div id="usMapSalesChart" class="center card-image waves-effect waves-block waves-light">

                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card">
                                    <!-- <div class="card-header black-text">Store Comparison</div> -->
                                    <div id="storeComparisonGraph" class="center card-image waves-effect waves-block waves-light">
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card">
                                    <div class="card-image waves-effect waves-block waves-light">
                                        <img class="activator" src="/images/girl1.jpg">
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card">
                                    <div class="card-image waves-effect waves-block waves-light">
                                        <img class="activator" src="/images/girl1.jpg">
                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card">
                                    <div id="" class="card-image waves-effect waves-block waves-light">

                                    </div>
                                    <div class="card-reveal">
                                        <span class="card-title grey-text text-darken-4">Item Name <i class="mdi-navigation-close right"></i></span>
                                        <p>Here is some more information about this product that is only revealed once clicked on.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="listItem">
        <div class="container">
            <div class="row">

                <div class="row" id="listItemDiv">
                    <div class="col s12 center-align ">
                        <h3>View All Items</h3>
                    </div>
                    <table class="bordered hoverable centered" id="itemListTable">
                        <thead>
                            <tr>
                                <th data-field="id">Item Id</th>
                                <th data-field="name">Item Name</th>
                                <th data-field="desc">Description</th>
                                <th data-field="price">Item Price</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr class="modal-trigger" href="#itemDetailsModal">
                                <td>1234</td>
                                <td>Alvin</td>
                                <td>Eclair</td>
                                <td>$0.87</td>
                            </tr>
                            <tr class="modal-trigger" href="#itemDetailsModal">
                                <td>1234</td>
                                <td>Alan</td>
                                <td>Jellybean</td>
                                <td>$3.76</td>
                            </tr>
                            <tr class="modal-trigger" href="#itemDetailsModal">
                                <td>1234</td>
                                <td>Jonathan</td>
                                <td>Lollipop</td>
                                <td>$7.00</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Modal Structure -->
                    <div id="itemDetailsModal" class="modal">
                        <div class="modal-content">
                            <h2 class="center-align">Item Details</h2>
                            <br>
                            <form class="col s12">
                                <div class="row">
                                    <div class="input-field col s6">
                                        <input id="name" type="text" class="validate">
                                        <label for="name">Item Name</label>
                                    </div>

                                    <div class="input-field col s6">
                                        <input id="desc" type="text" class="validate">
                                        <label for="desc">Description</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="input-field col s6">
                                        <input id="price" type="number" class="validate">
                                        <label for="price">Price</label>
                                    </div>

                                    <div class="input-field col s6">
                                        <input id="quantity" type="number" class="validate">
                                        <label for="quantity">Quantity</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="input-field col s6">
                                        <input id="features" type="text" class="validate">
                                        <label for="features">Features</label>
                                    </div>
                                    <div class="input-field col s6">
                                        <input id="discount" type="number" class="validate">
                                        <label for="discount">Discount</label>
                                    </div>
                                </div>
                            </form>
                            <p class="center-align"><a class="waves-effect waves-light btn"><i class="mdi-file-cloud left"></i>Update</a>
                                <a class="waves-effect waves-light btn"><i class="mdi-action-delete "></i></a></p>
                        </div>
                        <div class="modal-footer">
                            <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">X</a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        </div>
        </div>
        </div>
    </section>

    <section id="addItem">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="section">
                        <div class="row" id="addItemDiv">
                            <div class="col s12 center-align ">
                                <a class="btn-floating btn-large waves-effect waves-light red" onclick="addItemInDb()"><i class="mdi-content-add"></i></a>
                                <h3>Add Item</h3>
                            </div>
                            <form class="col s12">
                                <div class="row">
                                    <div class="input-field col s6">
                                        <input id="name" type="text" class="validate">
                                        <label for="name">Item Name</label>
                                    </div>

                                    <div class="input-field col s6">
                                        <input id="desc" type="text" class="validate">
                                        <label for="desc">Description</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="input-field col s6">
                                        <input id="price" type="number" class="validate">
                                        <label for="price">Price</label>
                                    </div>

                                    <div class="input-field col s6">
                                        <input id="quantity" type="number" class="validate">
                                        <label for="quantity">Quantity</label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="input-field col s12">
                                        <input id="features" type="text" class="validate">
                                        <label for="features">Enter the features</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="input-field col s12">
                                        <input id="retailer_id" type="number" class="validate">
                                        <label for="retailer_id">Enter your Retailer Id</label>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="input-field col s12">
                                        <input id="discount" type="number" class="validate">
                                        <label for="discount">Enter your Discount</label>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="listOrder">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">

                    <div class="section">

                        <div class="row" id="listOrderDiv">
                            <div class="col s12 center-align ">
                                <h3>View All Orders</h3>
                            </div>
                            <table class="bordered hoverable centered" id="orderListTable">
                                <thead>
                                    <tr>
                                        <th data-field="id">Item Id</th>
                                        <th data-field="name">Reciepent's Name</th>
                                        <th data-field="phone">Reciepent's Phone</th>
                                        <th data-field="card">Reciepent's Card</th>
                                        <th data-field="address">Address</th>
                                        <th data-field="created">Created At</th>
                                        <th data-field="created"> Status</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    <tr class="modal-trigger" href="#itemDetailsModal">
                                        <td>1234</td>
                                        <td>Alvin</td>
                                        <td>334455667</td>
                                        <td>33344589990909999999999</td>
                                        <td>1055 Escalon Ave, Sunnyvale, CA</td>
                                        <td>12/2/1014</td>
                                        <td>Pending</td>
                                    </tr>
                                    <tr class="modal-trigger" href="#itemDetailsModal">
                                        <td>1234</td>
                                        <td>Alvin</td>
                                        <td>334455667</td>
                                        <td>33344589990909999999999</td>
                                        <td>1055 Escalon Ave, Sunnyvale, CA</td>
                                        <td>12/2/1014</td>
                                        <td>Pending</td>
                                    </tr>
                                    <tr class="modal-trigger" href="#itemDetailsModal">
                                        <td>1234</td>
                                        <td>Alvin</td>
                                        <td>334455667</td>
                                        <td>33344589990909999999999</td>
                                        <td>1055 Escalon Ave, Sunnyvale, CA</td>
                                        <td>12/2/1014</td>
                                        <td>Pending</td>
                                    </tr>
                                </tbody>
                            </table>
                            <!-- Modal Structure -->
                            <div id="orderDetailsModal" class="modal">
                                <div class="modal-content">
                                    <h5 class="center-align">Order Summary</h5>
                                    <form class="col s12">
                                        <div class="row">
                                            <div class="input-field col s4">
                                                <input id="id" type="text" class="validate">
                                                <label for="id">Item Id</label>
                                            </div>

                                            <div class="input-field col s4">
                                                <input id="name" type="text" class="validate">
                                                <label for="name">Reciepent's Name</label>
                                            </div>

                                            <div class="input-field col s4">
                                                <input id="phone" type="number" class="validate">
                                                <label for="phone">Reciepent's Phone</label>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="input-field col s4">
                                                <input id="card" type="number" class="validate">
                                                <label for="card">Reciepent's Card</label>
                                            </div>

                                            <div class="input-field col s6">
                                                <input id="Address" type="number" class="validate">
                                                <label for="Address">Address</label>
                                            </div>
                                            <div class="input-field col s2">
                                                <input id="status" type="number" class="validate">
                                                <label for="Status">Status</label>
                                            </div>
                                        </div>


                                    </form>
                                    <p class="center-align"><a class="waves-effect waves-light btn"><i class="mdi-file-cloud left"></i>Update</a>
                                        <a class="waves-effect waves-light btn"><i class="mdi-action-delete "></i></a></p>
                                </div>
                                <div class="modal-footer">
                                    <a href="#!" class=" modal-action modal-close waves-effect btn-flat">X</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer id="footer">
        <div class="footer-widget">
            <div class="container">
                <div class="row">
                    <div class="col-sm-2">
                        <div class="single-widget">
                            <h2>Service</h2>
                            <ul class="nav nav-pills nav-stacked">
                                <li><a href="#">Online Help</a></li>
                                <li><a href="#">Contact Us</a></li>
                                <li><a href="#">Order Status</a></li>
                                <li><a href="#">Change Location</a></li>
                                <li><a href="#">FAQ’s</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="single-widget">
                            <h2>Quick Shop</h2>
                            <ul class="nav nav-pills nav-stacked">
                                <li><a href="#">T-Shirt</a></li>
                                <li><a href="#">Mens</a></li>
                                <li><a href="#">Womens</a></li>
                                <li><a href="#">Gift Cards</a></li>
                                <li><a href="#">Shoes</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="single-widget">
                            <h2>Policies</h2>
                            <ul class="nav nav-pills nav-stacked">
                                <li><a href="#">Terms of Use</a></li>
                                <li><a href="#">Privecy Policy</a></li>
                                <li><a href="#">Refund Policy</a></li>
                                <li><a href="#">Billing System</a></li>
                                <li><a href="#">Ticket System</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="single-widget">
                            <h2>About SPARTAN</h2>
                            <ul class="nav nav-pills nav-stacked">
                                <li><a href="#">Company Information</a></li>
                                <li><a href="#">Careers</a></li>
                                <li><a href="#">Store Location</a></li>
                                <li><a href="#">Affillate Program</a></li>
                                <li><a href="#">Copyright</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-3 col-sm-offset-1">
                        <div class="companyinfo">
                            <h2><span>E</span>-spartan</h2>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit,sed do eiusmod tempor</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="container">
                <div class="row">
                    <p class="pull-left">Copyright © 2013 E-SPARTAN Inc. All rights reserved.</p>
                    <p class="pull-right">Designed by <span><a href="#">CMPE 280  - Team 9</a></span></p>
                </div>
            </div>
        </div>
    </footer>
    <!--/Footer-->

    <!--  Scripts-->

    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="/javascripts/materialize.js"></script>

    <!-- HighCharts Library -->
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/data.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <!-- Additional files for the Highslide popup effect -->
    <script type="text/javascript" src="http://www.highcharts.com/media/com_demo/highslide-full.min.js"></script>
    <script type="text/javascript" src="http://www.highcharts.com/media/com_demo/highslide.config.js" charset="utf-8"></script>
    <!-- Additional files for HighMaps -->
    <script src="http://code.highcharts.com/maps/modules/map.js"></script>
    <script src="http://code.highcharts.com/mapdata/countries/us/us-all.js"></script>
    <script src="/js/customDashboardCharts.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            $(".button-collapse").sideNav();
            $('.modal-trigger').leanModal();
            showDashboard();
        });

        function loadCards() {
            loadDateCard();
            loadSaleCard();
        }

        function loadSaleCard() {
            var d = new Date();
            yr = d.getFullYear();
            month = d.getMonth() + 1;
            rid = 4;


            $.get("getAvgSalesByMonth", {
                year: yr,
                retailerid: rid
            }, function(res) {
                // console.log(res);
                res.forEach(function(obj) {
                    if (obj._id == month) {
                        avg = parseFloat(obj.avg).toFixed(2);
                        $('#avgSaleCard-month').html("$" + avg + "/Month");
                    }
                });
            });
            $.get("getAvgSalesByYear", {
                retailerid: rid
            }, function(res) {
                //console.log(res);
                res.forEach(function(obj) {

                    if (obj._id == yr) {
                        avg = parseFloat(obj.avg).toFixed(2);
                        $('#avgSaleCard-year').html("$" + avg + "/Year");
                    }
                });
            });

            $.get("getTotalSalesByMonth", {
                year: yr,
                retailerid: rid
            }, function(res) {
                //console.log(res);
                res.forEach(function(obj) {
                    if (obj._id == month) {
                        $('#totalSaleCard-month').html("$" + obj.sum + "/Month");
                    }
                });

            });
            $.get("getTotalSalesByYear", {
                retailerid: rid
            }, function(res) {
                //console.log(res);
                res.forEach(function(obj) {
                    if (obj._id == yr) {
                        $('#totalSaleCard-year').html("$" + obj.sum + "/Year");
                    }
                });
            });

            $.get("getSalesTrends", {
                startDate: "01/01/2015",
                endDate: new Date(),
                retailerid: rid
            }, function(res) {
                //console.log(res);
                var date = [];
                var sale = [];
                res.forEach(function(obj) {
                    var d = new Date(obj.date)
                    date[date.length] = d.getDate() + "-" + (d.getMonth() + 1);
                    sale[sale.length] = obj.sale;
                });
                // console.log(date);
                // console.log(sale);
                generateSaleTrendsGraph(date, sale);
            });

            $.get("getTopProducts", {year:2015, month:4, retailerid:rid} ,function(res) {
                console.log(res);
                var productIds = [];
                var quantity = [];
                res.forEach(function(obj) {
                    productIds[productIds.length] = obj._id;
                    quantity[quantity.length] = obj.qty;
                });
                
                $('#topProductsChart').highcharts({
                    chart:{type:'bar'},
                    title:{text:'Top Products'},
                    xAxis:{categories: productIds, title:{text:null}},
                    yAxis:{min:0, title:{text:null, align: 'high'}},
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true,
                                borderWidth: 0
                            },
                            borderWidth: 0
                        }
                    },
                    series: [{
                        name: 'This Month',
                        data: quantity
                    }]
                    
                });
            });
            $.get("getSaleByLocation", function(res) {
                $('#totalSaleCardyear').html("$" + res + "/Year");
            });

            // getTopProducts
            // ge2tSaleByLocation
        }

        function loadDateCard() {
            //console.log("loadDateCard");
            var d = new Date();
            var weekday = new Array(7);
            weekday[0] = "Sunday";
            weekday[1] = "Monday";
            weekday[2] = "Tuesday";
            weekday[3] = "Wednesday";
            weekday[4] = "Thursday";
            weekday[5] = "Friday";
            weekday[6] = "Saturday";

            var day = weekday[d.getDay()].toUpperCase();
            $('#dateCard-day').html(day);
            $('#dateCard-date').html(d.toLocaleDateString());
            $('#dateCard-time').html(d.toLocaleTimeString());
        }

        function showDashboard() {
            $('#retailerDashboard').show();
            $('#listItem').hide();
            $('#addItem').hide();
            $('#listOrder').hide();
            loadCards();
        }

        function addItem() {
            $('#retailerDashboard').hide();
            $('#retailerDashboard2').hide();
            $('#listItem').hide();
            $('#addItem').show();
            $('#listOrder').hide();
        }

        function updateOrder() {
            $('#retailerDashboard').hide();
            $('#retailerDashboard2').hide();
            $('#listItem').hide();
            $('#addItem').hide();
            $('#listOrder').hide();
        }

        function getItemList() {
            console.log("getting Item List");
            $("#itemListTable tbody").empty();
            $.get("item", function(res) {
                console.log("success");
                console.log(res);
                res.forEach(function(thisdata) {
                    var tr = "<tr id=\"" + thisdata.name + "\" onclick=\"openItemDetails(\'" + thisdata.name + "\') \">";
                    tr += "<td>" + thisdata._id + "</td>";
                    tr += "<td>" + thisdata.name + "</td>";
                    tr += "<td>" + thisdata.description + "</td>";
                    tr += "<td>" + "$" + thisdata.price + "</td>";
                    tr += "</tr>";
                    $("#itemListTable tbody").append(tr);
                });
            });
            $('#retailerDashboard').hide();
            $('#retailerDashboard2').hide();
            $('#listItem').show();
            $('#addItem').hide();
            $('#listOrder').hide();
        }

        function getOrderList() {
            console.log("getting order List");

            $('#retailerDashboard').hide();
            $('#retailerDashboard2').hide();
            $('#listItem').hide();
            $('#addItem').hide();
            $('#listOrder').show();
        }

        function logOut() {
            console.log("logout");
            $.post("/logout").done(function(res) {
                if (!res.type) {
                    console.log("Please try again.");
                } else {
                    window.location.href = "/";
                }
            });
        }

        function openItemDetails(vmName) {
            console.log("openItemDetails(" + vmName + ")");
            var instances = JSON.parse(sessionStorage.getItem("instances"));
            console.log('/vm/' + vmName + '/statistics');
            $.ajax({
                url: '/vm/' + vmName + '/statistics',
                type: 'GET',
                async: true,
                crossDomain: true, // enable this
                dataType: "json",
                cache: false,
                success: function(res) {
                    console.log(res.data);
                    visitorData(res.data);
                }
            });
            instances.forEach(function(thisinstance) {
                if (thisinstance.name == vmName) {
                    console.log(thisinstance);
                    $('#vmDetailsHeading').text(thisinstance.name);
                    $('#vmDetailsType').text(thisinstance.type);
                    $('#vmDetailsRam').text(thisinstance.ram);
                    $('#vmDetailsCPU').text(thisinstance.cpu);
                    $('#vmDetailsStatus').text(thisinstance.status);
                } else {
                    return;
                }
            });
            $('#vmDetails').openModal();
        }

        function openModal(templateName) {
            console.log(templateName);
            templatenameglobal = templateName;
            $('#deployVM').openModal();
        }

        function generateSaleTrendsGraph(date, sale){
                $('#saleTrendsGraph').highcharts({
                    chart: {

                        height: 300
                    },

                    title: {
                        text: 'Sale Trends'
                    },
                    xAxis: {
                        categories: date
                    },
                    yAxis: {
                        title: {
                            text: 'Sales'
                        },
                    },
                    series: [{
                        name: 'Date',
                        data: sale
                    }]
                });
        }

    </script>

</body>

</html>